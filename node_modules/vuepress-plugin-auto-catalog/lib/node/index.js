import{useSassPalettePlugin as K}from"vuepress-plugin-sass-palette";import{Logger as $,ensureEndingSlash as C,getTitleFromFilename as E,checkVersion as T,getLocales as _,addViteSsrNoExternal as L}from"vuepress-shared/node";import{createPage as M}from"@vuepress/core";import{getDirname as x,path as G,colors as m}from"@vuepress/utils";const I=x(import.meta.url),y="vuepress-plugin-auto-catalog",f=new $(y),v=C(G.resolve(I,"../client")),w=({pages:e},{component:a,iconGetter:o,iconRouteMetaKey:i="icon",shouldIndex:p,indexRouteMetaKey:d="index",orderGetter:l,orderRouteMetaKey:r="order",titleGetter:s=t=>t.title,titleRouteMetaKey:g="title"})=>{a||e.forEach(t=>{const c={},n=s?.(t),u=o?.(t),h=p?.(t)??null,A=l?.(t)??null;n&&(c[g]=n),u&&(c[i]=u),typeof h=="boolean"&&(c[d]=h?1:0),typeof A=="number"&&(c[r]=A),t.routeMeta={...t.routeMeta,...c}})},R=async(e,{component:a="AutoCatalog",exclude:o=[],frontmatter:i=()=>({}),level:p=3,index:d=!1})=>{const{env:{isDebug:l},pages:r}=e,s=new Set,g=`<${a}${[1,2].includes(p)?` :level="${p}"`:""}${d?" index":""}/>
`;r.forEach(({path:t,pathLocale:c})=>{let n=t;if(t!=="/404.html")for(;n!==c;)n=n.replace(/\/(?:[^/]+\/?)$/,"/"),!s.has(n)&&o.every(u=>!n.match(u))&&r.every(({path:u})=>u!==n)&&(l&&f.info(`Generating catalog ${n}}`),s.add(n))}),await Promise.all(Array.from(s).map(t=>decodeURI(t)).map(t=>{const[,c=""]=/\/([^/]+)\/?$/.exec(t)||[],n=E(c);return M(e,{frontmatter:{title:n,...i(t)||{}},content:g,path:t})})).then(t=>{e.pages.push(...t)})},O=({options:e,deprecatedOption:a,newOption:o,msg:i="",scope:p=""})=>{if(a in e){if(f.warn(`${m.magenta(a)} is ${m.yellow("deprecated")}${p?` in ${p}`:""}, please use "${m.magenta(o)}" instead.${i?`
${i}`:""}`),o.includes(".")){const d=o.split(".");let l=e;d.forEach((r,s)=>{s!==d.length-1?(l[r]=l[r]||{},l=l[r]):l[r]=e[a]})}else e[o]=e[a];delete e[a]}},k=(e,a,o="",i="")=>{a in e&&(f.error(`"${m.magenta(a)}" is ${m.red("removed")}${i?`, please use ${m.magenta(i)} instead.`:" and no longer supported"}${o?`
${o}`:""}`),i||delete e[a])},N=e=>{O({options:e,deprecatedOption:"getTitle",newOption:"titleGetter"}),O({options:e,deprecatedOption:"getIcon",newOption:"iconGetter"}),O({options:e,deprecatedOption:"getOrder",newOption:"orderGetter"}),O({options:e,deprecatedOption:"getIndex",newOption:"shouldIndex"}),k(e,"iconComponent",`please use ${m.magenta("defineAutoCatalogIconComponent")} in client config file.`)},D={"/en/":{title:"Catalog",empty:"No catalog"},"/zh/":{title:"目录",empty:"暂无目录"},"/zh-tw/":{title:"目錄",empty:"暫無目錄"},"/de/":{title:"Katalog",empty:"Kein Katalog"},"/de-at/":{title:"Katalog",empty:"Kein Katalog"},"/vi/":{title:"Danh mục",empty:"Không có danh mục"},"/uk/":{title:"Каталог",empty:"Немає каталогу"},"/ru/":{title:"Каталог",empty:"Нет каталога"},"/br/":{title:"Catálogo",empty:"Sem catálogo"},"/pl/":{title:"Katalog",empty:"Brak katalogu"},"/sk/":{title:"Katalóg",empty:"Žiadny katalóg"},"/fr/":{title:"Catalogue",empty:"Pas de catalogue"},"/es/":{title:"Catálogo",empty:"Sin catálogo"},"/ja/":{title:"カタログ",empty:"カタログなし"},"/tr/":{title:"Katalog",empty:"Katalog yok"},"/ko/":{title:"목차",empty:"목차 없음"},"/fi/":{title:"Luettelo",empty:"Ei luetteloa"},"/hu/":{title:"Katalógus",empty:"Nincs katalógus"},"/id/":{title:"Katalog",empty:"Tidak ada katalog"},"/nl/":{title:"Catalogus",empty:"Geen catalogus"}},P=(e={},a=!0)=>o=>{a&&N(e),T(o,y,"2.0.0-rc.0"),o.env.isDebug&&f.info("Options:",e),K(o,{id:"hope"});const{component:i,iconRouteMetaKey:p="icon",indexRouteMetaKey:d="index",locales:l,orderRouteMetaKey:r="order",titleRouteMetaKey:s="title"}=e;return{name:y,define:()=>({AUTO_CATALOG_LOCALES:_({app:o,name:y,default:D,config:l}),AUTO_CATALOG_TITLE_META_KEY:s,AUTO_CATALOG_ICON_META_KEY:p,AUTO_CATALOG_ORDER_META_KEY:r,AUTO_CATALOG_INDEX_META_KEY:d}),onInitialized:async g=>{w(g,e),await R(g,e)},extendsBundlerOptions:(g,t)=>{L(g,t,"vuepress-shared")},...i?{}:{clientConfigFile:`${v}config.js`}}};export{P as autoCatalogPlugin};
//# sourceMappingURL=index.js.map
