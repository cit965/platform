{"version":3,"file":"VuePlayground.js","sources":["../../../src/client/utils/playground.ts","../../../src/client/components/VuePlayground.ts"],"sourcesContent":["import type { VuePlaygroundOptions } from \"../typings/index.js\";\n\nexport const getVuePlaygroundSettings = (\n  settings: string,\n): VuePlaygroundOptions =>\n  <VuePlaygroundOptions>JSON.parse(decodeURIComponent(settings));\n","import type { Repl, ReplProps, ReplStore } from \"@vue/repl\";\nimport type { EditorComponentType } from \"@vue/repl/codemirror-editor\";\nimport type { VNode } from \"vue\";\nimport { computed, defineComponent, h, onMounted, ref, shallowRef } from \"vue\";\nimport { LoadingIcon, deepAssign } from \"vuepress-shared/client\";\n\nimport { useVuePlaygroundConfig } from \"../helpers/index.js\";\nimport { getVuePlaygroundSettings } from \"../utils/index.js\";\n\nimport \"@vue/repl/style.css\";\nimport \"../styles/vue-playground.scss\";\n\nexport default defineComponent({\n  name: \"VuePlayground\",\n\n  props: {\n    /**\n     * Playground title\n     *\n     * 演示标题\n     */\n    title: {\n      type: String,\n      default: \"\",\n    },\n\n    /**\n     * Playground file data\n     *\n     * 演示文件数据\n     */\n    files: { type: String, required: true },\n\n    /**\n     * Playground settings\n     *\n     * 演示设置\n     */\n    settings: { type: String, default: \"{}\" },\n  },\n\n  setup(props) {\n    const vuePlaygroundOptions = useVuePlaygroundConfig();\n    const loading = ref(true);\n    const component = shallowRef<typeof Repl>();\n    const store = shallowRef<ReplStore>();\n    const editor = shallowRef<EditorComponentType>();\n\n    const playgroundOptions = computed(() =>\n      deepAssign(\n        {},\n        vuePlaygroundOptions,\n        getVuePlaygroundSettings(props.settings),\n      ),\n    );\n\n    const setupRepl = async (): Promise<void> => {\n      const [{ ReplStore, Repl }, { default: codeMirror }] = await Promise.all([\n        import(/* webpackChunkName: \"vue-repl\" */ \"@vue/repl\"),\n        import(\n          /* webpackChunkName: \"vue-repl\" */ \"@vue/repl/codemirror-editor\"\n        ),\n      ]);\n\n      component.value = Repl;\n      editor.value = codeMirror;\n      store.value = new ReplStore({\n        serializedState: decodeURIComponent(props.files),\n      });\n\n      if (playgroundOptions.value.vueVersion)\n        await store.value.setVueVersion(playgroundOptions.value.vueVersion);\n    };\n\n    onMounted(async () => {\n      await setupRepl();\n      loading.value = false;\n    });\n\n    return (): (VNode | null)[] => [\n      h(\"div\", { class: \"vue-playground-wrapper\" }, [\n        props.title\n          ? h(\"div\", { class: \"header\" }, decodeURIComponent(props.title))\n          : null,\n        h(\n          \"div\",\n          {\n            class: \"repl-container\",\n          },\n          [\n            loading.value\n              ? h(LoadingIcon, { class: \"preview-loading\", height: 192 })\n              : null,\n            component.value\n              ? h(component.value, <ReplProps>{\n                  editor: editor.value,\n                  store: store.value,\n                  autoResize: true,\n                  ...playgroundOptions.value,\n                  layout: \"horizontal\",\n                })\n              : null,\n          ],\n        ),\n      ]),\n    ];\n  },\n});\n"],"names":["getVuePlaygroundSettings","settings","VuePlayground","defineComponent","props","vuePlaygroundOptions","useVuePlaygroundConfig","loading","ref","component","shallowRef","store","editor","playgroundOptions","computed","deepAssign","setupRepl","ReplStore","Repl","codeMirror","onMounted","h","LoadingIcon"],"mappings":"2RAEO,MAAMA,EACXC,GAEsB,KAAK,MAAM,mBAAmBA,CAAQ,CAAC,ECO/D,IAAAC,EAAeC,EAAgB,CAC7B,KAAM,gBAEN,MAAO,CAML,MAAO,CACL,KAAM,OACN,QAAS,EACX,EAOA,MAAO,CAAE,KAAM,OAAQ,SAAU,EAAK,EAOtC,SAAU,CAAE,KAAM,OAAQ,QAAS,IAAK,CAC1C,EAEA,MAAMC,EAAO,CACX,MAAMC,EAAuBC,EAAuB,EAC9CC,EAAUC,EAAI,EAAI,EAClBC,EAAYC,EAAwB,EACpCC,EAAQD,EACRE,EAAAA,EAASF,EAAgC,EAEzCG,EAAoBC,EAAS,IACjCC,EACE,CAAA,EACAV,EACAL,EAAyBI,EAAM,QAAQ,CACzC,CACF,EAEMY,EAAY,SAA2B,CAC3C,KAAM,CAAC,CAAE,UAAAC,EAAW,KAAAC,CAAK,EAAG,CAAE,QAASC,CAAW,CAAC,EAAI,MAAM,QAAQ,IAAI,CACvE,OAA0C,WAAW,EACrD,OACqC,6BACrC,CACF,CAAC,EAEDV,EAAU,MAAQS,EAClBN,EAAO,MAAQO,EACfR,EAAM,MAAQ,IAAIM,EAAU,CAC1B,gBAAiB,mBAAmBb,EAAM,KAAK,CACjD,CAAC,EAEGS,EAAkB,MAAM,YAC1B,MAAMF,EAAM,MAAM,cAAcE,EAAkB,MAAM,UAAU,CACtE,EAEA,OAAAO,EAAU,SAAY,CACpB,MAAMJ,EAAU,EAChBT,EAAQ,MAAQ,EAClB,CAAC,EAEM,IAAwB,CAC7Bc,EAAE,MAAO,CAAE,MAAO,wBAAyB,EAAG,CAC5CjB,EAAM,MACFiB,EAAE,MAAO,CAAE,MAAO,QAAS,EAAG,mBAAmBjB,EAAM,KAAK,CAAC,EAC7D,KACJiB,EACE,MACA,CACE,MAAO,gBACT,EACA,CACEd,EAAQ,MACJc,EAAEC,EAAa,CAAE,MAAO,kBAAmB,OAAQ,GAAI,CAAC,EACxD,KACJb,EAAU,MACNY,EAAEZ,EAAU,MAAkB,CAC5B,OAAQG,EAAO,MACf,MAAOD,EAAM,MACb,WAAY,GACZ,GAAGE,EAAkB,MACrB,OAAQ,YACV,CAAC,EACD,IACN,CACF,CACF,CAAC,CACH,CACF,CACF,CAAC"}