import{usePageData as c,useSiteData as f}from"@vuepress/client";import{defineComponent as k,ref as v,shallowRef as w,onMounted as y,watch as l,h as o,nextTick as g}from"vue";import{isString as h,LoadingIcon as D}from"vuepress-shared/client";import"artalk/dist/Artalk.css";import"../styles/artalk.scss";import{u as M}from"../index-wG_My4pN.js";var A=k({name:"Artalk",props:{identifier:{type:String,required:!0},darkmode:Boolean},setup(e){const a=M(),d=c(),s=f(),i=v(!1),n=w();let t=null;const m=h(a.server),u=async()=>{const[{default:r}]=await Promise.all([import("artalk/dist/Artalk.es.js"),new Promise(p=>{setTimeout(()=>{p()},a.delay||800)})]);i.value=!0,await g();try{t=new r({useBackendConf:!1,site:s.value.title,pageTitle:d.value.title,...a,el:n.value,pageKey:e.identifier,darkMode:e.darkmode}),a.useBackendConf&&t.on("conf-loaded",()=>{t.setDarkMode(e.darkmode)})}catch{}};return y(()=>{l(()=>e.identifier,async()=>{try{t?.destroy()}catch{}await u()},{immediate:!0}),l(()=>e.darkmode,r=>{t?.setDarkMode(r)})}),()=>m?o("div",{class:"artalk-wrapper"},[i.value?null:o(D),o("div",{ref:n})]):null}});export{A as default};
//# sourceMappingURL=Artalk.js.map
