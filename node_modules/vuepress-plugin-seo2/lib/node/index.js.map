{"version":3,"file":"index.js","sources":["../../src/node/utils.ts","../../src/node/compact/utils.ts","../../src/node/compact/convert.ts","../../src/node/description.ts","../../src/node/info.ts","../../src/node/inject.ts","../../src/node/seo.ts","../../src/node/plugin.ts"],"sourcesContent":["import type { App, Page } from \"@vuepress/core\";\nimport {\n  Logger,\n  entries,\n  isAbsoluteUrl,\n  isLinkHttp,\n  isString,\n  isUrl,\n  removeEndingSlash,\n  removeLeadingSlash,\n} from \"vuepress-shared/node\";\n\nimport type { SeoOptions } from \"./options.js\";\nimport type { ExtendPage } from \"./typings/index.js\";\n\nexport const PLUGIN_NAME = \"vuepress-plugin-seo2\";\n\nexport const logger = new Logger(PLUGIN_NAME);\n\nexport interface AlternateInfo {\n  path: string;\n  lang: string;\n}\n\nexport const getAlternateInfo = (\n  { lang, path, pathLocale }: Page,\n  { pages, siteData }: App,\n): AlternateInfo[] =>\n  entries(siteData.locales)\n    .map(([localePath, { lang }]) => ({\n      path: `${localePath}${path.replace(pathLocale, \"\")}`,\n      lang,\n    }))\n    .filter(\n      (item): item is AlternateInfo =>\n        isString(item.lang) &&\n        item.lang !== lang &&\n        pages.some(({ path }) => path === item.path),\n    );\n\nexport const getCover = (\n  { frontmatter }: ExtendPage,\n  { options: { base } }: App,\n  { hostname }: SeoOptions,\n): string | null => {\n  const { banner, cover } = frontmatter;\n\n  if (banner) {\n    if (isAbsoluteUrl(banner)) return resolveUrl(hostname, base, banner);\n\n    if (isUrl(banner)) return banner;\n  }\n\n  if (cover) {\n    if (isAbsoluteUrl(cover)) return resolveUrl(hostname, base, cover);\n\n    if (isUrl(cover)) return cover;\n  }\n\n  return null;\n};\n\nexport const getImages = (\n  { content }: ExtendPage,\n  { options: { base } }: App,\n  { hostname }: SeoOptions,\n): string[] => {\n  const result = /!\\[.*?\\]\\((.*?)\\)/giu.exec(content);\n\n  if (result)\n    return result\n      .map(([, link]) => {\n        if (isAbsoluteUrl(link)) return resolveUrl(hostname, base, link);\n\n        if (isUrl(link)) return link;\n\n        return null;\n      })\n      .filter((item): item is string => item !== null);\n\n  return [];\n};\n\nexport const resolveUrl = (\n  hostname: string,\n  base: string,\n  url: string,\n): string =>\n  `${\n    isLinkHttp(hostname)\n      ? removeEndingSlash(hostname)\n      : `https://${removeEndingSlash(hostname)}`\n  }${base}${removeLeadingSlash(url)}`;\n","import { colors } from \"@vuepress/utils\";\n\nimport { logger } from \"../utils.js\";\n\nexport const droppedLogger = (\n  options: Record<string, unknown>,\n  droppedOption: string,\n  hint = \"\",\n  newOption = \"\",\n): void => {\n  if (droppedOption in options) {\n    logger.error(\n      `\"${colors.magenta(droppedOption)}\" is ${colors.red(\"removed\")}${\n        newOption\n          ? `, please use ${colors.magenta(newOption)} instead.`\n          : \" and no longer supported\"\n      }${hint ? `\\n${hint}` : \"\"}`,\n    );\n\n    if (!newOption) delete options[droppedOption];\n  }\n};\n","import { droppedLogger } from \"./utils.js\";\nimport type { SeoOptions } from \"../options.js\";\n\n/** @deprecated */\nexport const convertOptions = (\n  options: SeoOptions & Record<string, unknown>,\n): void => {\n  droppedLogger(options, \"seo\", \"\", \"ogp\");\n  droppedLogger(options, \"customMeta\", \"\", \"customHead\");\n};\n","import { getPageText, stripTags } from \"vuepress-shared/node\";\n\nimport type { ExtendPage } from \"./typings/index.js\";\n\nexport const generateDescription = (\n  page: ExtendPage,\n  autoDescription = true,\n): void => {\n  // generate description\n  if (!page.frontmatter.description && autoDescription) {\n    if (page.data.excerpt) {\n      page.frontmatter.description = stripTags(page.data.excerpt)\n        // convert link breaks into spaces\n        .replace(/(?:\\r?\\n)+/g, \" \")\n        // convert 2 or more spaces into 1\n        .replace(/ +/g, \" \")\n        .trim();\n    } else {\n      const pageText = getPageText(page);\n\n      page.frontmatter.description =\n        pageText.length > 180 ? `${pageText.slice(0, 177)}...` : pageText;\n    }\n\n    page.data.autoDesc = true;\n  }\n};\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { App } from \"@vuepress/core\";\nimport {\n  getAuthor,\n  getDateInfo,\n  isArray,\n  isFunction,\n  isString,\n  removeEndingSlash,\n} from \"vuepress-shared/node\";\n\nimport type { SeoOptions } from \"./options.js\";\nimport type {\n  ArticleSchema,\n  BlogPostingSchema,\n  ExtendPage,\n  SeoContent,\n  WebPageSchema,\n} from \"./typings/index.js\";\nimport { getAlternateInfo, getCover, getImages, resolveUrl } from \"./utils.js\";\n\nexport const getOGP = (\n  page: ExtendPage,\n  options: SeoOptions,\n  app: App,\n): SeoContent => {\n  const {\n    isArticle = (page): boolean =>\n      Boolean(page.filePathRelative && !page.frontmatter[\"home\"]),\n    author: globalAuthor,\n  } = options;\n  const {\n    options: { base },\n    siteData,\n  } = app;\n  const {\n    frontmatter: {\n      author: pageAuthor,\n      time,\n      date = time,\n      tag,\n      tags = <string[]>tag,\n    },\n    data: { git = {} },\n  } = page;\n\n  const title =\n    siteData.locales[page.pathLocale]?.title ||\n    siteData.title ||\n    siteData.locales[\"/\"]?.title ||\n    \"\";\n  const author =\n    pageAuthor === false ? [] : getAuthor(pageAuthor || globalAuthor);\n  const modifiedTime = git.updatedTime\n    ? new Date(git.updatedTime).toISOString()\n    : null;\n  const articleTags = isArray(tags) ? tags : isString(tag) ? [tag] : [];\n  const articleTitle = page.title;\n  const cover = getCover(page, app, options);\n  const images = getImages(page, app, options);\n  const locales = getAlternateInfo(page, app);\n  const publishedTime = getDateInfo(date)?.value?.toISOString();\n\n  const ogImage = cover || images[0] || options.fallBackImage || \"\";\n\n  const defaultOGP: SeoContent = {\n    \"og:url\": resolveUrl(options.hostname, base, page.path),\n    \"og:site_name\": title,\n    \"og:title\": articleTitle,\n    \"og:description\": page.frontmatter.description || \"\",\n    \"og:type\": isArticle(page) ? \"article\" : \"website\",\n    \"og:image\": ogImage,\n    \"og:locale\": page.lang,\n    \"og:locale:alternate\": locales.map(({ lang }) => lang),\n    ...(modifiedTime ? { \"og:updated_time\": modifiedTime } : {}),\n    ...(options.restrictions\n      ? { \"og:restrictions:age\": options.restrictions }\n      : {}),\n\n    ...(options.twitterID ? { \"twitter:creator\": options.twitterID } : {}),\n    ...(ogImage\n      ? {\n          \"twitter:card\": \"summary_large_image\",\n          \"twitter:image:alt\": articleTitle,\n        }\n      : {}),\n\n    \"article:author\": author[0]?.name,\n    \"article:tag\": articleTags,\n    ...(publishedTime ? { \"article:published_time\": publishedTime } : {}),\n    ...(modifiedTime ? { \"article:modified_time\": modifiedTime } : {}),\n  };\n\n  return defaultOGP;\n};\n\nexport const getJSONLD = (\n  page: ExtendPage,\n  options: SeoOptions,\n  app: App,\n): ArticleSchema | BlogPostingSchema | WebPageSchema => {\n  const {\n    isArticle = (page): boolean =>\n      Boolean(page.filePathRelative && !page.frontmatter[\"home\"]),\n    author: globalAuthor,\n  } = options;\n\n  const {\n    title,\n    frontmatter: { author: pageAuthor, description, time, date = time },\n    data: { git = {} },\n  } = page;\n\n  const author =\n    pageAuthor === false ? [] : getAuthor(pageAuthor || globalAuthor);\n  const datePublished = getDateInfo(date)?.value?.toISOString();\n  const dateModified = git.updatedTime\n    ? new Date(git.updatedTime).toISOString()\n    : null;\n  const cover = getCover(page, app, options);\n  const images = getImages(page, app, options);\n\n  return isArticle(page)\n    ? {\n        \"@context\": \"https://schema.org\",\n        \"@type\": \"Article\",\n        headline: title,\n        image: images.length ? images : [cover || options.fallBackImage || \"\"],\n        datePublished,\n        dateModified,\n        author: author.map((item) => ({ \"@type\": \"Person\", ...item })),\n      }\n    : {\n        \"@context\": \"https://schema.org\",\n        \"@type\": \"WebPage\",\n        name: title,\n        ...(description ? { description } : {}),\n      };\n};\n\nexport const getCanonicalLink = (\n  page: ExtendPage,\n  options: SeoOptions,\n): string | null =>\n  isFunction(options.canonical)\n    ? options.canonical(page)\n    : isString(options.canonical)\n      ? `${removeEndingSlash(options.canonical)}${page.path}`\n      : null;\n\nexport const getAlternateLinks = (\n  page: ExtendPage,\n  { hostname }: SeoOptions,\n  app: App,\n): { lang: string; path: string }[] =>\n  getAlternateInfo(page, app).map(({ lang, path }) => ({\n    lang,\n    path: resolveUrl(hostname, app.options.base, path),\n  }));\n","import type { HeadConfig } from \"@vuepress/core\";\nimport { startsWith } from \"vuepress-shared/node\";\n\nimport type {\n  ArticleSchema,\n  ArticleSeoContent,\n  BlogPostingSchema,\n  SeoContent,\n  WebPageSchema,\n} from \"./typings/index.js\";\n\ninterface MetaOptions {\n  name: string;\n  content: string;\n  attribute?: string;\n}\n\nconst appendMetaToHead = (\n  head: HeadConfig[],\n  {\n    name,\n    content,\n    attribute = [\"article:\", \"og:\"].some((type) => startsWith(name, type))\n      ? \"property\"\n      : \"name\",\n  }: MetaOptions,\n): void => {\n  if (content) head.push([\"meta\", { [attribute]: name, content }]);\n};\n\nexport const addOGP = (head: HeadConfig[], content: SeoContent): void => {\n  for (const property in content)\n    switch (property) {\n      case \"article:tag\":\n        (<ArticleSeoContent>content)[\"article:tag\"]!.forEach((tag: string) =>\n          appendMetaToHead(head, { name: \"article:tag\", content: tag }),\n        );\n        break;\n      case \"og:locale:alternate\":\n        content[\"og:locale:alternate\"].forEach((locale: string) => {\n          if (locale !== content[\"og:locale\"])\n            appendMetaToHead(head, {\n              name: \"og:locale:alternate\",\n              content: locale,\n            });\n        });\n        break;\n      default:\n        if (<string>content[<keyof SeoContent>property])\n          appendMetaToHead(head, {\n            name: property,\n            content: <string>content[<keyof SeoContent>property],\n          });\n    }\n};\n\nexport const appendJSONLD = (\n  head: HeadConfig[],\n  content: ArticleSchema | BlogPostingSchema | WebPageSchema,\n): void => {\n  head.push([\n    \"script\",\n    { type: \"application/ld+json\" },\n    JSON.stringify(content),\n  ]);\n};\n\nexport const appendCanonical = (\n  head: HeadConfig[],\n  url?: string | null,\n): void => {\n  if (url) head.push([\"link\", { rel: \"canonical\", href: url }]);\n};\n\nexport const appendAlternate = (\n  head: HeadConfig[],\n  urls: { lang: string; path: string }[],\n): void => {\n  urls.forEach(({ lang, path }) => {\n    head.push([\n      \"link\",\n      { rel: \"alternate\", hreflang: lang.toLowerCase(), href: path },\n    ]);\n  });\n};\n","/* eslint-disable @typescript-eslint/naming-convention */\nimport type { App, AppDir } from \"@vuepress/core\";\nimport { fs } from \"@vuepress/utils\";\n\nimport {\n  getAlternateLinks,\n  getCanonicalLink,\n  getJSONLD,\n  getOGP,\n} from \"./info.js\";\nimport {\n  addOGP,\n  appendAlternate,\n  appendCanonical,\n  appendJSONLD,\n} from \"./inject.js\";\nimport type { SeoOptions } from \"./options.js\";\nimport type { ExtendPage } from \"./typings/index.js\";\nimport { logger } from \"./utils.js\";\n\nexport const appendSEO = (app: App, options: SeoOptions): void => {\n  app.pages.forEach((page: ExtendPage) => {\n    const head = page.frontmatter.head || [];\n\n    const canonicalLink = getCanonicalLink(page, options);\n    const alternateLinks = getAlternateLinks(page, options, app);\n\n    appendCanonical(head, canonicalLink);\n    appendAlternate(head, alternateLinks);\n\n    if (page.frontmatter[\"seo\"] !== false) {\n      const defaultOGP = getOGP(page, options, app);\n      const defaultJSONLD = getJSONLD(page, options, app);\n\n      const ogpContent = options.ogp\n        ? options.ogp(defaultOGP, page, app)\n        : defaultOGP;\n\n      const jsonLDContent = options.jsonLd\n        ? options.jsonLd(defaultJSONLD, page, app)\n        : defaultJSONLD;\n\n      addOGP(head, ogpContent);\n      appendJSONLD(head, jsonLDContent);\n\n      if (options.customHead) options.customHead(head, page, app);\n    }\n\n    page.frontmatter.head = head;\n  });\n};\n\nexport const generateRobotsTxt = async (dir: AppDir): Promise<void> => {\n  logger.load(\"Generating robots.txt\");\n  const publicPath = dir.public(\"robots.txt\");\n\n  let content = fs.existsSync(publicPath)\n    ? await fs.readFile(publicPath, { encoding: \"utf8\" })\n    : \"\";\n\n  if (content && !content.includes(\"User-agent\")) {\n    logger.error();\n    logger.update(\"robots.txt seems invalid!\");\n  } else {\n    content += \"\\nUser-agent:*\\nDisallow:\\n\";\n\n    await fs.writeFile(dir.dest(\"robots.txt\"), content, {\n      flag: \"w\",\n    });\n\n    logger.succeed();\n  }\n};\n","import type { Plugin, PluginFunction } from \"@vuepress/core\";\nimport { colors } from \"@vuepress/utils\";\nimport { checkVersion } from \"vuepress-shared/node\";\n\nimport { convertOptions } from \"./compact/index.js\";\nimport { generateDescription } from \"./description.js\";\nimport type { SeoOptions } from \"./options.js\";\nimport { appendSEO, generateRobotsTxt } from \"./seo.js\";\nimport type { ExtendPage } from \"./typings/index.js\";\nimport { PLUGIN_NAME, logger } from \"./utils.js\";\n\nexport const seoPlugin =\n  (options: SeoOptions, legacy = true): PluginFunction =>\n  (app) => {\n    // TODO: Remove this in v2 stable\n    if (legacy) convertOptions(options as SeoOptions & Record<string, unknown>);\n    checkVersion(app, PLUGIN_NAME, \"2.0.0-rc.0\");\n\n    if (app.env.isDebug) logger.info(\"Options:\", options);\n\n    const plugin: Plugin = { name: PLUGIN_NAME };\n\n    if (!options.hostname) {\n      logger.error(`Option ${colors.magenta(\"hostname\")} is required!`);\n\n      return plugin;\n    }\n\n    return {\n      ...plugin,\n\n      extendsPage: (page: ExtendPage): void => {\n        if (page.frontmatter.seo !== false)\n          generateDescription(page, options.autoDescription !== false);\n      },\n\n      onInitialized: (app): void => {\n        appendSEO(app, options);\n      },\n\n      onGenerated: (app): Promise<void> => generateRobotsTxt(app.dir),\n    };\n  };\n"],"names":["PLUGIN_NAME","logger","Logger","getAlternateInfo","lang","path","pathLocale","pages","siteData","entries","localePath","item","isString","getCover","frontmatter","base","hostname","banner","cover","isAbsoluteUrl","resolveUrl","isUrl","getImages","content","result","link","url","isLinkHttp","removeEndingSlash","removeLeadingSlash","droppedLogger","options","droppedOption","hint","newOption","colors","convertOptions","generateDescription","page","autoDescription","stripTags","pageText","getPageText","getOGP","app","isArticle","globalAuthor","pageAuthor","time","date","tag","tags","git","title","author","getAuthor","modifiedTime","articleTags","isArray","articleTitle","images","locales","publishedTime","getDateInfo","ogImage","getJSONLD","description","datePublished","dateModified","getCanonicalLink","isFunction","getAlternateLinks","appendMetaToHead","head","name","attribute","type","startsWith","addOGP","property","locale","appendJSONLD","appendCanonical","appendAlternate","urls","appendSEO","canonicalLink","alternateLinks","defaultOGP","defaultJSONLD","ogpContent","jsonLDContent","generateRobotsTxt","dir","publicPath","fs","seoPlugin","legacy","checkVersion","plugin"],"mappings":"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"}