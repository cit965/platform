import i from"mitt";import{provide as a,onMounted as n}from"vue";import{p as m}from"../usePWAEvent-PKhQONiA.js";import{withBase as s}from"@vuepress/client";import{r as c,f as d}from"../registerSW-yJv5QOgX.js";const f=async t=>c(s(SW_PATH),{ready(e){t.emit("ready",e)},registered(e){t.emit("registered",e)},cached(e){t.emit("cached",e)},updatefound(e){t.emit("updatefound",e)},updated(e){const r="service-worker-version",o=Number(localStorage.getItem(r)||0);localStorage.setItem(r,(o+1).toString()),localStorage.removeItem("manifest"),t.emit("updated",e)},offline(){t.emit("offline")},error(e){t.emit("error",e)}}),l=()=>{if(__VUEPRESS_SSR__)return;const t=i();a(m,t),n(async()=>{if(__VUEPRESS_DEV__)return;let e=!1;navigator.serviceWorker?.controller&&navigator.serviceWorker.addEventListener("controllerchange",()=>{e||(e=!0,window.location.reload())}),SW_FORCE_UPDATE&&d(),await f(t)})};export{l as setupPWA};
//# sourceMappingURL=setup.js.map
