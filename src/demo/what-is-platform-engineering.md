
---
title: 什么是平台工程
icon: fab fa-markdown
order: 1
category:
  - 使用指南
tag:
  - Markdown
---

平台工程是设计和构建工具链和工作流的学科，这些工具链和工作流在云原生时代为软件工程组织提供自助服务功能。平台工程师提供一种集成产品，通常称为“内部开发人员平台”，涵盖应用程序整个生命周期的操作需求。

平台工程是设计和构建工具链和工作流的学科，这些工具链和工作流在云原生时代为软件工程组织提供自助服务功能。平台工程师提供一种集成产品，通常称为“内部开发人员平台”，涵盖应用程序整个生命周期的操作需求。内部开发人员平台 （IDP） 包含各种技术和工具，其集成方式可减少开发人员的认知负担，同时保留基本上下文和底层技术。它可以帮助运营人员构建其设置并启用开发人员自助服务。正确完成平台工程意味着提供与与 IDP 交互的单个开发人员的首选抽象级别相匹配的黄金路径和铺砌道路。

在本文中，我们将探讨这门学科的起源，并讨论平台工程师的主要关注领域。我们还将解释这如何适应现代工程组织的设置，并且实际上是大多数高级开发团队的关键组成部分


## 从DevOps的灰烬中：内部开发人员平台的兴起

让我们把时间拨回到几十年前。在 90 年代末和 2000 年代初，大多数设置都有一个网关守卫（和故障点），即 SysAdmin。如果开发人员想要完成任何事情来运行他们的应用程序，他们必须通过它们。在实践中，这转化为众所周知的“扔过围栏”工作流程，这导致了围栏两边的糟糕体验。作为一个行业，我们都同意这不是我们应该追求的理想。


与此同时，随着 AWS 于 2006 年推出，DevOps 的概念逐渐普及，并成为工程团队的新黄金标准。虽然云原生在可扩展性、可用性和可操作性等方面推动了巨大的改进，但这也意味着设置变得更加复杂。运行单个脚本来部署使用一个关系数据库的整体式应用程序的日子已经一去不复返了。

突然之间，工程师必须掌握 10 种不同的工具、Helm 图表、Terraform 模块等，才能在多集群微服务设置中将简单的代码更改部署到多个环境之一。问题在于，在整个工具链的演变过程中，该行业似乎认为分工（Ops 和 Devs）并不是一个好主意，而这在全球经济的几乎所有其他部门都被证明是成功的。相反，DevOps范式被倡导为实现高性能设置的方法。

## 开发人员应该能够端到端地部署和运行其应用和服务。“你建造它，你运行它”。真正的 DevOps


这种方法的问题在于，对于大多数公司来说，这实际上是相当不现实的。虽然上述内容适用于Google，Amazon或Airbnb等非常先进的组织，但对于大多数其他团队来说，在实践中复制真正的DevOps远非易事。主要原因是，大多数公司不太可能获得相同的人才库和相同水平的资源，他们可以投资于优化其开发人员的工作流程和体验。


相反，当一个常规的工程组织试图实现真正的DevOps时，往往会出现一系列的反模式。团队拓扑团队（Matthew Skelton 和 Manuel Pais，在我们的平台工程师聚会上发表演讲）在他们对 DevOps 反类型的分析中很好地记录了这一点，对于想要更好地了解这些动态的任何人来说，这都是一本强烈推荐的书。下面是一个示例，说明当组织决定实施 DevOps 并删除正式的 Ops 角色或团队时，许多开发团队中出现的情况。开发人员（通常是更高级的开发人员）最终负责管理环境、基础设施等。这导致了一种设置，其中“影子操作”由相同的工程师执行，他们在编码和产品开发方面的投入是最有价值的。每个人都输了。高级工程师现在负责设置，需要解决更多初级同事的要求。更广泛的组织现在正在滥用其一些最昂贵和最有才华的资源，并且无法以相同的速度和可靠性发布功能。

![](https://assets-global.website-files.com/6489e23dd070ba71d41a33b2/649163cff008fbb11c51cb9f_6200ce7b574bad7eea1a5e1b_61bcb69ae99f82039b617b4d_image4.png)


许多研究都证明了这种类型的反模式，例如 Puppet 的 DevOps 状态，或者最近的 Humanitec 的 Benchmarking 研究。在后者中，根据标准的DevOps指标（提前期、部署频率、MTTR等）对表现最好的组织和表现较差的组织进行聚类。如下图所示，令人震惊的是，44% 的低绩效组织经历了上述反模式，一些开发人员自己完成 DevOps 任务并帮助经验不足的同事。相比之下，100%的组织已经成功地实施了真正的“你构建，你运行它”的方法。

![](https://assets-global.website-files.com/6489e23dd070ba71d41a33b2/649163cff008fbb11c51cb8c_61b9f9aaebee22c4b1ba5afb_x9YlbS4e6p3pgBD_OLxgWLYn_Ahyoa0CGqXGJGE7WWMOqfa3bCQZM3SLuKlTF_tIWML1asHQZYkTj2FAgge9rew0sIwc_s02k5A4neK1gkoWw11BO8qN7NyUG8ZH1-e4VmfcDMFN.png)


那么，低绩效组织和最佳组织之间的主要区别是什么？最好的团队如何确保他们的开发人员能够运行他们的应用程序和服务，而不需要高级同事的持续帮助？你猜对了，他们有一个平台团队在构建一个内部开发人员平台。Puppet 的《2020 年 DevOps 现状报告》清楚地显示了内部平台的使用与组织 DevOps 演进程度之间的相关性

![](https://assets-global.website-files.com/6489e23dd070ba71d41a33b2/649163cff008fbb11c51cb90_6200ce7bde33ea575c4ef155_61bcb6b49498923cdc9c70b5_image2.png)


这就是最好的工程组织所做的。他们建立了内部平台团队来建立 IDP。使用这些 IDP 时，开发人员可以根据自己的喜好选择正确的抽象级别来运行他们的应用程序和服务，即他们是否喜欢弄乱 Helm 图表、YAML 文件和 Terraform 模块？太好了，他们可以这样做。他们是不在乎应用程序是否在 EKS 上运行的初级前端吗？太棒了，他们可以自助服务一个环境，该环境完全配置了部署和测试代码所需的一切，而不必担心代码在哪里运行。

## 金色小径和铺砌的道路

我们所说的黄金之路和铺砌的道路是什么意思？让我们更具体一点。如今，大多数 CI/CD 设置都专注于简单地更新映像。CI 构建它们，更新配置中的映像路径，完成。这涵盖了大多数部署用例。但是，每当我们需要做这个基本工作流程之外的任何事情时，事情就会变得越来越复杂和耗时，例如：

- 添加环境变量和更改配置
- 添加服务和依赖项
- 回滚和调试
- 启动新环境
-  重构
-  添加/更改资源
-  强制执行 RBAC


这样的例子不胜枚举。平台工程就是将所有这些绑定到一条铺好的道路上。平台工程师不是让每个人都操作所有内容，也不必了解整个工具链，而是提供粘合剂，将所有内容绑定到一致的自助服务体验中。

这种胶水是内部平台。用 Evan Bottcher （Thoughtworks） 的话来说，平台是“自助服务 API、工具、服务、知识和支持的基础，它们被安排为一个引人注目的内部产品。自主交付团队可以利用该平台以更快的速度交付产品功能，同时减少协调。


在此定义的基础上，Humanitec 的 Kaspar von Gruenberg 将内部开发人员平台定义为“平台工程团队结合在一起为开发人员铺平黄金道路的所有技术和工具的总和”。

## 平台工程原理

许多组织正在意识到内部开发人员平台和开发人员自助服务的好处。引用 Puppet 的 2021 年 DevOps 现状报告，“平台团队的存在并不能本质上解锁更高演进的 DevOps;然而，优秀的平台团队会扩展DevOps计划的好处。

不过，雇用合适的人才来构建这样的平台和工作流程可能很棘手。更棘手的是，要确保他们始终如一地向工程组织的其他成员提供可靠的产品，并将他们的反馈纳入 IDP。


以下是一些有用的原则，我认为这些原则是成功的平台团队和自助服务驱动型组织的共同点：

###  明确使命和角色

平台团队需要明确的使命。例如：“构建可靠的工作流，使工程师能够独立地与我们的设置进行交互，并自助提供运行其应用和服务所需的基础架构”。无论什么对你的团队最有意义，都要确保从一开始就定义它。为平台团队建立明确的角色也非常重要，不应将其视为另一个按需启动环境的帮助台，而应被视为为内部客户提供服务的专用产品团队。

### 将您的平台视为产品

扩展产品重点，平台团队需要以产品思维为驱动力。他们需要根据内部客户（应用程序开发人员）的反馈，专注于为内部客户（应用程序开发人员）提供真正价值的内容。确保他们基于这个反馈循环发布功能，并且不会因为玩弄刚刚出现的闪亮新技术而分心。

### 关注常见问题

平台团队通过一遍又一遍地解决共同的问题来防止内部的其他团队重新发明轮子。弄清楚这些常见问题是什么是关键：首先要了解开发人员的痛点和导致开发速度放缓的摩擦领域。这些信息既可以通过开发人员的反馈进行定性收集，也可以通过工程 KPI 进行定量收集。


### 胶水很有价值

通常，平台团队被视为纯粹的成本中心，因为他们不会为最终用户提供任何实际的产品功能。毕竟，他们只是将我们的系统粘合在一起。这是一个非常危险的观点，当然，这种胶水非常有价值。平台工程师需要在内部接受和宣传自己和他们的价值主张。一旦你为你的团队设计了黄金路径和铺好的道路，你作为一个平台团队创造的主要价值就是成为粘性粘合剂，将工具链整合在一起，并确保你的工程师有一个顺畅的自助服务工作流程。

### 不要重新发明轮子

就像平台团队应该阻止组织内的其他团队重新发明轮子并找到新的创造性解决方案来解决相同的问题一样，他们也应该避免陷入同样的谬误。无论您的本土 CI/CD 解决方案在今天是否更胜一筹，商业供应商最终都会迎头赶上。平台团队应该始终问他们的差异化因素是什么。与其构建 CI 系统或指标仪表板的内部替代方案，并与容量是其 20 或 50 倍的企业竞争，不如专注于组织的特定需求，并根据他们的要求定制现成的解决方案。无论如何，商业竞争对手更有可能针对行业更通用的需求进行优化。

## 现代工程组织

根据 Puppet 的 2021 年 DevOps 现状报告，“高度进化的组织倾向于遵循团队拓扑模型”。

Matthew Skelton 和 Manuel Pais 于 2019 年出版的《团队拓扑》一书成为成功工程组织中现代团队设置最具影响力的蓝图之一。根据他们的蓝图，团队应该围绕四种基本拓扑来构建自己。

![](https://assets-global.website-files.com/6489e23dd070ba71d41a33b2/649163cff008fbb11c51cb7f_6200ce7bd990123f344dd5fb_61bcb6da0bed343cd2612f81_image5.png)

- 流对齐的团队：与业务领域某个部分的工作流保持一致，他们处理核心业务逻辑。
- 赋能团队：帮助流对齐的团队克服障碍并检测缺失的功能。
- 复杂的子系统团队：每当需要重要的数学/技术专长时，就会形成。
- 平台团队：提供一个引人注目的内部平台，以加速流对齐团队的交付

如上图所示，平台团队与所有其他团队是横向的，确保了从代码到生产的顺畅的自助服务工作流程。

## 你什么时候应该看这个？

一个常见的误解是，平台工程只有在大型团队中才有意义。虽然您的团队由 5 名开发人员组成，那么平台团队和 IDP 肯定是矫枉过正，但一旦您的组织超过 20-30 名开发人员，内部开发人员平台可能是您应该考虑的东西，宜早不宜迟。我听说过无数团队的故事，他们推迟了太久的 IDP 构建，不得不遭受不必要的困难，例如，您唯一的 DevOps 员工离开了，您的整个组织在几周内无法部署。IDP 和招聘平台工程师是您今天可能要考虑的投资。


## 如何开始

如果你正在阅读这篇文章，你已经完成了一半。参加我们的活动，加入社区微信群，与其他平台工程师和平台书互动。跟随其他团队的旅程，例如 Adevinta、Flywire 等。与社区分享您的团队遇到的困难，并了解自助服务在何时何地可能有意义。查看围绕内部开发人员平台的现有产品/服务，以快速开始您的旅程。从轻量级开始，并不断迭代用例。